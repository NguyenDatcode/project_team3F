{% extends 'layout/base.html' %}
{% block content %}

<div id="heroCarousel" class="carousel slide mb-4" data-bs-ride="carousel">
    <div class="carousel-inner">

        <div class="carousel-item active">
            <img src="https://one.phudonggroup.com/wp-content/uploads/2025/08/cv-1-scaled.png" class="d-block w-100">
        </div>

        <div class="carousel-item">
            <img src="https://one.phudonggroup.com/wp-content/uploads/2025/08/cv-3-scaled.png" class="d-block w-100">
        </div>

        <div class="carousel-item">
            <img src="https://one.phudonggroup.com/wp-content/uploads/2025/08/cv-4-scaled.png" class="d-block w-100">
        </div>

    </div>

    <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
    </button>
</div>

<div class="container mb-4">
    <h3>Căn hộ nổi bật</h3>
    <p>Thực hiện hóa ước mơ nghề nghiệp và nơi ở dành cho bạn.</p>
</div>

<hr>

<!-- ================== SEARCH + FILTER ================== -->
<div class="container mb-4">
    <form method="GET" action="{{ url_for('home_page') }}" class="row g-2">

        <div class="col-md-5">
            <input type="text"
                   name="q"
                   class="form-control"
                   placeholder="Tìm kiếm căn hộ..."
                   value="{{ q }}">
        </div>

        <div class="col-md-4">
            <select name="type" class="form-select">
                <option value="">Tất cả loại</option>
                {% for t in types %}
                <option value="{{ t.id }}"
                    {% if selected_type|int == t.id %}selected{% endif %}>
                    {{ t.tenLoai }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-3">
            <button type="submit" class="btn btn-primary w-100">
                <i class="bi bi-search"></i> Tìm kiếm
            </button>
        </div>

    </form>
</div>


<div class="container">
    <div class="row">

        {% for p in apartment %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm position-relative">

                <img src="{{ p.image_url }}" class="card-img-top" alt="{{ p.title }}">

                {% if p.is_vip %}
                <span class="badge bg-danger position-absolute m-2">HOT</span>
                {% endif %}

                <div class="card-body">
                    <h5 class="card-title">{{ p.title }}</h5>
                    <p class="card-text">
                        <strong>{{ p.price }} triệu/tháng</strong><br>
                        <i class="bi bi-rulers"></i> {{ p.area }} m²<br>
                        <i class="bi bi-geo-alt"></i> {{ p.location }}
                    </p>

                    <!-- Nút liên hệ Zalo -->
                    <a href="https://zalo.me/0703172549" target="_blank" class="btn btn-success w-100 mt-2">
                        <i class="bi bi-chat-dots"></i> Liên hệ Zalo
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}

    </div>
</div>


<div class="container mt-4">
    <nav>
        <ul class="pagination justify-content-center">

            <li class="page-item {% if page == 1 %}disabled{% endif %}">
                <a class="page-link"
                   href="{{ url_for('home_page', page=page-1, q=q, type=selected_type) }}">
                    « Previous
                </a>
            </li>

            {% for p in range(1, total_pages + 1) %}
            <li class="page-item {% if p == page %}active{% endif %}">
                <a class="page-link"
                   href="{{ url_for('home_page', page=p, q=q, type=selected_type) }}">
                    {{ p }}
                </a>
            </li>
            {% endfor %}

            <li class="page-item {% if page == total_pages %}disabled{% endif %}">
                <a class="page-link"
                   href="{{ url_for('home_page', page=page+1, q=q, type=selected_type) }}">
                    Next »
                </a>
            </li>

        </ul>
    </nav>
</div>


<a href="https://zalo.me/0703172549" target="_blank"
   style="position:fixed; bottom:20px; right:20px; z-index:9999;"
   class="btn btn-success btn-lg rounded-circle shadow">
   <i class="bi bi-chat-dots"></i>
</a>

{% endblock %}
